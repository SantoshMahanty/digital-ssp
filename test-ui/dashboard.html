<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - Digital-SSP</title>
  <link rel="stylesheet" href="assets/styles.css">
</head>
<body>
  <header>
    <div class="header-content">
      <div class="logo">
        <div class="logo-icon">DS</div>
        <div>
          <h1>Digital-SSP</h1>
          <p style="font-size: 0.875rem; color: var(--text-secondary);">Overview Dashboard</p>
        </div>
      </div>
      <nav>
        <a href="index.html">Ad Tester</a>
        <a href="inspector.html">Inspector</a>
        <a href="dashboard.html" class="active">Dashboard</a>
      </nav>
    </div>
  </header>

  <div class="container">
    <!-- Key Metrics -->
    <div class="card">
      <div class="card-header">
        <div>
          <h2 class="card-title">ğŸ“Š Delivery Snapshot</h2>
          <p class="card-subtitle">Mock real-time metrics</p>
        </div>
        <button class="btn btn-secondary" onclick="refreshMetrics()">ğŸ”„ Refresh</button>
      </div>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-label">Ad Requests</div>
          <div class="stat-value" id="requests">1.2M</div>
          <div class="stat-change">â†‘ 5.2% vs yesterday</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Impressions</div>
          <div class="stat-value" id="impressions">860k</div>
          <div class="stat-change">â†‘ 3.8% vs yesterday</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Fill Rate</div>
          <div class="stat-value" id="fillRate">71.6%</div>
          <div class="stat-change">â†“ 1.2% vs yesterday</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">eCPM</div>
          <div class="stat-value" id="ecpm">$3.42</div>
          <div class="stat-change">â†‘ 8.5% vs yesterday</div>
        </div>
      </div>
    </div>

    <div class="grid grid-2">
      <!-- Active Line Items -->
      <div class="card">
        <div class="card-header">
          <div>
            <h2 class="card-title">ğŸ¯ Active Line Items</h2>
            <p class="card-subtitle">Currently running campaigns</p>
          </div>
        </div>

        <table>
          <thead>
            <tr>
              <th>Line Item</th>
              <th>Priority</th>
              <th>Pacing</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                <strong>Sponsor Homepage</strong>
                <div style="font-size: 0.875rem; color: var(--text-secondary);">CPM: $8.00</div>
              </td>
              <td><span class="badge badge-info">4</span></td>
              <td>
                <span class="badge badge-success">On Track</span>
                <div style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.25rem;">
                  42k / 100k imps
                </div>
              </td>
              <td><span class="badge badge-success">Running</span></td>
            </tr>
            <tr>
              <td>
                <strong>Standard News</strong>
                <div style="font-size: 0.875rem; color: var(--text-secondary);">CPM: $6.50</div>
              </td>
              <td><span class="badge badge-info">6</span></td>
              <td>
                <span class="badge badge-warning">Under</span>
                <div style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.25rem;">
                  15k / 50k imps
                </div>
              </td>
              <td><span class="badge badge-success">Running</span></td>
            </tr>
            <tr>
              <td>
                <strong>Price Priority Display</strong>
                <div style="font-size: 0.875rem; color: var(--text-secondary);">CPM: $5.00</div>
              </td>
              <td><span class="badge badge-info">10</span></td>
              <td>
                <span class="badge badge-error">Over</span>
                <div style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.25rem;">
                  82k / 75k imps
                </div>
              </td>
              <td><span class="badge badge-success">Running</span></td>
            </tr>
            <tr>
              <td>
                <strong>House Fallback</strong>
                <div style="font-size: 0.875rem; color: var(--text-secondary);">CPM: $0.50</div>
              </td>
              <td><span class="badge badge-info">16</span></td>
              <td>
                <span class="badge badge-info">N/A</span>
                <div style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.25rem;">
                  Unlimited
                </div>
              </td>
              <td><span class="badge badge-success">Ready</span></td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Top Ad Units -->
      <div class="card">
        <div class="card-header">
          <div>
            <h2 class="card-title">ğŸ“ Top Ad Units</h2>
            <p class="card-subtitle">By impression volume (24h)</p>
          </div>
        </div>

        <table>
          <thead>
            <tr>
              <th>Ad Unit</th>
              <th>Requests</th>
              <th>Fill Rate</th>
              <th>eCPM</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>news/home/hero</code></td>
              <td>340k</td>
              <td><span class="badge badge-success">85.2%</span></td>
              <td>$4.20</td>
            </tr>
            <tr>
              <td><code>news/article/sidebar</code></td>
              <td>280k</td>
              <td><span class="badge badge-success">72.8%</span></td>
              <td>$2.85</td>
            </tr>
            <tr>
              <td><code>sports/live/banner</code></td>
              <td>190k</td>
              <td><span class="badge badge-warning">68.4%</span></td>
              <td>$3.95</td>
            </tr>
            <tr>
              <td><code>entertainment/video/preroll</code></td>
              <td>160k</td>
              <td><span class="badge badge-success">91.5%</span></td>
              <td>$8.50</td>
            </tr>
            <tr>
              <td><code>finance/mobile/footer</code></td>
              <td>95k</td>
              <td><span class="badge badge-error">45.2%</span></td>
              <td>$1.75</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Performance by Geo -->
    <div class="card">
      <div class="card-header">
        <div>
          <h2 class="card-title">ğŸŒ Geographic Performance</h2>
          <p class="card-subtitle">Breakdown by region (24h)</p>
        </div>
      </div>

      <table>
        <thead>
          <tr>
            <th>Region</th>
            <th>Requests</th>
            <th>Impressions</th>
            <th>Fill Rate</th>
            <th>Revenue</th>
            <th>eCPM</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>ğŸ‡ºğŸ‡¸ United States</td>
            <td>640k</td>
            <td>485k</td>
            <td><span class="badge badge-success">75.8%</span></td>
            <td>$2,134</td>
            <td>$4.40</td>
          </tr>
          <tr>
            <td>ğŸ‡¬ğŸ‡§ United Kingdom</td>
            <td>180k</td>
            <td>128k</td>
            <td><span class="badge badge-success">71.1%</span></td>
            <td>$486</td>
            <td>$3.80</td>
          </tr>
          <tr>
            <td>ğŸ‡¨ğŸ‡¦ Canada</td>
            <td>140k</td>
            <td>102k</td>
            <td><span class="badge badge-success">72.9%</span></td>
            <td>$367</td>
            <td>$3.60</td>
          </tr>
          <tr>
            <td>ğŸ‡©ğŸ‡ª Germany</td>
            <td>120k</td>
            <td>85k</td>
            <td><span class="badge badge-warning">70.8%</span></td>
            <td>$289</td>
            <td>$3.40</td>
          </tr>
          <tr>
            <td>ğŸ‡¦ğŸ‡º Australia</td>
            <td>90k</td>
            <td>58k</td>
            <td><span class="badge badge-warning">64.4%</span></td>
            <td>$197</td>
            <td>$3.40</td>
          </tr>
          <tr>
            <td>ğŸŒ Other</td>
            <td>30k</td>
            <td>18k</td>
            <td><span class="badge badge-error">60.0%</span></td>
            <td>$38</td>
            <td>$2.10</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- System Status -->
    <div class="grid grid-3">
      <div class="card">
        <div class="card-header">
          <div>
            <h2 class="card-title">ğŸ’¾ PostgreSQL</h2>
            <p class="card-subtitle">Configuration DB</p>
          </div>
        </div>
        <div style="display: flex; align-items: center; gap: 1rem;">
          <div style="width: 12px; height: 12px; border-radius: 50%; background: var(--success);"></div>
          <div>
            <div style="font-weight: 600; color: var(--success);">Connected</div>
            <div style="font-size: 0.875rem; color: var(--text-secondary);">23ms latency</div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <div>
            <h2 class="card-title">âš¡ Redis</h2>
            <p class="card-subtitle">Caching & Counters</p>
          </div>
        </div>
        <div style="display: flex; align-items: center; gap: 1rem;">
          <div style="width: 12px; height: 12px; border-radius: 50%; background: var(--success);"></div>
          <div>
            <div style="font-weight: 600; color: var(--success);">Connected</div>
            <div style="font-size: 0.875rem; color: var(--text-secondary);">5ms latency</div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <div>
            <h2 class="card-title">ğŸ“Š ClickHouse</h2>
            <p class="card-subtitle">Analytics DB</p>
          </div>
        </div>
        <div style="display: flex; align-items: center; gap: 1rem;">
          <div style="width: 12px; height: 12px; border-radius: 50%; background: var(--success);"></div>
          <div>
            <div style="font-weight: 600; color: var(--success);">Connected</div>
            <div style="font-size: 0.875rem; color: var(--text-secondary);">18ms latency</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="card">
      <div class="card-header">
        <div>
          <h2 class="card-title">âš¡ Quick Actions</h2>
          <p class="card-subtitle">Common testing tasks</p>
        </div>
      </div>

      <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
        <a href="index.html" class="btn btn-primary">
          ğŸ¯ Test Ad Request
        </a>
        <a href="inspector.html" class="btn btn-primary">
          ğŸ” Inspect Request
        </a>
        <button class="btn btn-secondary" onclick="simulateTraffic()">
          ğŸš€ Simulate Traffic
        </button>
        <button class="btn btn-secondary" onclick="clearCache()">
          ğŸ—‘ï¸ Clear Cache
        </button>
      </div>
    </div>

    <!-- Recent Activity -->
    <div class="card">
      <div class="card-header">
        <div>
          <h2 class="card-title">ğŸ“œ Recent Activity</h2>
          <p class="card-subtitle">Latest system events</p>
        </div>
      </div>

      <div class="timeline">
        <div class="timeline-item success">
          <div style="display: flex; justify-content: space-between;">
            <div>
              <strong>Line Item Updated</strong>
              <div style="color: var(--text-secondary); font-size: 0.875rem;">
                "Sponsor Homepage" pacing adjusted to even delivery
              </div>
            </div>
            <div style="font-size: 0.875rem; color: var(--text-secondary);">2 min ago</div>
          </div>
        </div>

        <div class="timeline-item success">
          <div style="display: flex; justify-content: space-between;">
            <div>
              <strong>Ad Request Filled</strong>
              <div style="color: var(--text-secondary); font-size: 0.875rem;">
                news/home/hero â†’ Sponsor Homepage ($8.00 CPM)
              </div>
            </div>
            <div style="font-size: 0.875rem; color: var(--text-secondary);">5 min ago</div>
          </div>
        </div>

        <div class="timeline-item error">
          <div style="display: flex; justify-content: space-between;">
            <div>
              <strong>No Fill</strong>
              <div style="color: var(--text-secondary); font-size: 0.875rem;">
                sports/article/sidebar â†’ No eligible line items (targeting)
              </div>
            </div>
            <div style="font-size: 0.875rem; color: var(--text-secondary);">12 min ago</div>
          </div>
        </div>

        <div class="timeline-item success">
          <div style="display: flex; justify-content: space-between;">
            <div>
              <strong>Creative Uploaded</strong>
              <div style="color: var(--text-secondary); font-size: 0.875rem;">
                New 970x250 display creative for "Standard News"
              </div>
            </div>
            <div style="font-size: 0.875rem; color: var(--text-secondary);">1 hour ago</div>
          </div>
        </div>

        <div class="timeline-item success">
          <div style="display: flex; justify-content: space-between;">
            <div>
              <strong>Floor Updated</strong>
              <div style="color: var(--text-secondary); font-size: 0.875rem;">
                US desktop display floor increased to $1.50 CPM
              </div>
            </div>
            <div style="font-size: 0.875rem; color: var(--text-secondary);">2 hours ago</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    function refreshMetrics() {
      // Simulate random metric changes
      const requests = (Math.random() * 0.5 + 1.0).toFixed(1);
      const impressions = Math.floor(parseFloat(requests) * 1000000 * (Math.random() * 0.2 + 0.65));
      const fillRate = ((impressions / (parseFloat(requests) * 1000000)) * 100).toFixed(1);
      const ecpm = (Math.random() * 2 + 2.5).toFixed(2);

      document.getElementById('requests').textContent = requests + 'M';
      document.getElementById('impressions').textContent = Math.floor(impressions / 1000) + 'k';
      document.getElementById('fillRate').textContent = fillRate + '%';
      document.getElementById('ecpm').textContent = '$' + ecpm;

      // Show success message
      const message = document.createElement('div');
      message.className = 'alert alert-success';
      message.style.position = 'fixed';
      message.style.top = '100px';
      message.style.right = '20px';
      message.style.zIndex = '1000';
      message.innerHTML = '<div><strong>âœ… Metrics Refreshed</strong></div>';
      document.body.appendChild(message);

      setTimeout(() => {
        message.remove();
      }, 2000);
    }

    function simulateTraffic() {
      const count = prompt('How many ad requests to simulate?', '100');
      if (count && !isNaN(count)) {
        alert(`ğŸš€ Simulating ${count} ad requests...\n\nThis would send ${count} requests to your API endpoint in a background worker.`);
      }
    }

    function clearCache() {
      if (confirm('Clear all Redis cache entries?')) {
        alert('ğŸ—‘ï¸ Cache cleared successfully!\n\nThis would execute FLUSHDB in Redis.');
      }
    }

    // Auto-refresh metrics every 30 seconds
    setInterval(refreshMetrics, 30000);
  </script>
</body>
</html>
